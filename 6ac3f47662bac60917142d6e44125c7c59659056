- many small fixes, mostly inspired by kloczek
